import{r as t,h as e,c as s,g as l}from"./p-e58cd209.js";class i{constructor(t,e=!1,s=function(){let t="";for(let e=0;e<32;e++){const s=16*Math.random()|0;8!==e&&12!==e&&16!==e&&20!==e||(t+="-"),t+=(12===e?4:16===e?3&s|8:s).toString(16)}return t}()){this.title=t,this.completed=e,this.id=s}}class o{constructor(){this.todos=[]}add(t){return this.save(this.todos.concat(new i(t)))}editTitle(t,e){return this.edit(t.id,(t=>Object.assign(Object.assign({},t),{title:e})))}toggleCompleted(t){return this.edit(t.id,(t=>Object.assign(Object.assign({},t),{completed:!t.completed})))}toggleAll(t){return this.save(this.todos.map((e=>Object.assign(Object.assign({},e),{completed:t}))))}delete(t){return this.save(this.todos.filter((e=>e.id!==t.id)))}clearCompleted(){return this.save(this.todos.filter((t=>!t.completed)))}load(){return this.todos=window.localStorage?JSON.parse(localStorage.getItem("todos-stencil")||"[]"):[]}save(t){return window.localStorage&&localStorage.setItem("todos-stencil",JSON.stringify(t)),this.todos=t}edit(t,e){return this.save(this.todos.map((s=>t===s.id?e(s):s)))}}const h=class{constructor(e){t(this,e),this.todoService=new o,this.todos=this.todoService.load(),this.filter="all"}get filteredTodos(){switch(this.filter){case"active":return this.todos.filter((t=>!t.completed));case"completed":return this.todos.filter((t=>t.completed));default:return this.todos}}componentWillLoad(){this.updateFilterFromUrl(document.location.href)}render(){return e("section",{class:"todoapp"},e("header",{class:"header"},e("h1",null,"todos"),e("input",{class:"new-todo",placeholder:"What needs to be done?",autoComplete:"on",autoFocus:!0,onKeyUp:t=>this.onKeyUp(t)})),e("todo-list",{todos:this.filteredTodos}),this.todos.length>0?e("todo-footer",{todos:this.todos,filter:this.filter}):null)}todoDeleted(t){this.todos=this.todoService.delete(t.detail)}toggleCompleted(t){this.todos=this.todoService.toggleCompleted(t.detail)}editTitle(t){this.todos=this.todoService.editTitle(t.detail.todo,t.detail.newTitle)}toggleAll(t){this.todos=this.todoService.toggleAll(t.detail)}onKeyUp(t){if(13===t.keyCode){const e=t.target;""!==e.value.trim()&&(this.todos=this.todoService.add(e.value),e.value="")}}hashChanged(t){this.updateFilterFromUrl(t.newURL)}updateFilterFromUrl(t){this.filter=t&&t.split("#/")[1]||"all"}clearCompleted(){this.todos=this.todoService.clearCompleted()}},c=class{constructor(e){t(this,e),this.clearCompleted=s(this,"clearCompleted",7)}render(){let t=null;return this.todos.some((t=>t.completed))&&(t=e("button",{class:"clear-completed",onClick:this.clearCompleted.emit},"Clear completed")),e("footer",{class:"footer"},this.renderTodoCount(),e("ul",{class:"filters"},e("li",null,e("a",{class:{selected:"all"===this.filter},href:"#/"},"All")),e("li",null,e("a",{class:{selected:"active"===this.filter},href:"#/active"},"Active")),e("li",null,e("a",{class:{selected:"completed"===this.filter},href:"#/completed"},"Completed"))),t)}renderTodoCount(){const t=this.todos.filter((t=>!t.completed)).length;return e("span",{class:"todo-count"},e("strong",null,t)," ",t>1||t<1?"items":"item"," left")}},r=class{constructor(e){t(this,e),this.todoDeleted=s(this,"todoDeleted",7),this.toggleCompleted=s(this,"toggleCompleted",7),this.editTitle=s(this,"editTitle",7),this.toggleAll=s(this,"toggleAll",7)}render(){return this.todos.length<=0?null:e("section",{class:"main"},e("input",{id:"toggle-all",class:"toggle-all",type:"checkbox",onClick:()=>this.onToggleAll(),checked:this.allCompleted()}),e("label",{htmlFor:"toggle-all"},"Mark all as complete"),e("ul",{class:"todo-list"},this.todos.map((t=>this.renderTodo(t)))))}renderTodo(t){return e("li",{class:{completed:t.completed,editing:t.id===this.editing}},e("div",{class:"view"},e("input",{class:"toggle",type:"checkbox",checked:t.completed,onChange:()=>this.toggle(t)}),e("label",{onDblClick:()=>this.edit(t)},t.title),e("button",{class:"destroy",onClick:()=>this.deleteTodo(t)})),e("input",{class:"edit",onBlur:e=>this.doneEdit(t,e),onKeyUp:e=>this.onKeyUp(t,e),value:t.title}))}allCompleted(){return 0===this.todos.filter((t=>!t.completed)).length}toggle(t){this.toggleCompleted.emit(t)}deleteTodo(t){this.todoDeleted.emit(t)}onToggleAll(){this.toggleAll.emit(!this.allCompleted())}edit(t){this.editing=t.id,setTimeout((()=>{const t=this.el.getElementsByClassName("editing")[0].getElementsByClassName("edit")[0];t.focus(),t.selectionStart=t.value.length}),0)}onKeyUp(t,e){13===e.keyCode?this.doneEdit(t,e):27===e.keyCode&&(this.editing=null)}doneEdit(t,e){this.editing=null;const s=e.target.value.trim();s&&s.length>0?this.editTitle.emit({todo:t,newTitle:s}):this.deleteTodo(t)}get el(){return l(this)}};export{h as todo_app,c as todo_footer,r as todo_list}